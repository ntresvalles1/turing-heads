// Generated by dts-bundle-generator v7.2.0

import { Remote } from 'comlink';

/**
 * Options for customizing the progress tracker.
 */
export interface ProgressTrackerOptions {
	/** The weight of the progress, a number between 0 and 1. */
	weight?: number;
	/** The caption to display during progress, a string. */
	caption?: string;
	/** The time in milliseconds to fill the progress, a number. */
	fillTime?: number;
}
/**
 * Custom event providing information about a loading process.
 */
export type LoadingEvent = CustomEvent<{
	/** The number representing how much was loaded. */
	loaded: number;
	/** The number representing how much needs to loaded in total. */
	total: number;
}>;
/**
 * Custom event providing progress details.
 */
export type ProgressTrackerEvent = CustomEvent<ProgressDetails>;
export interface ProgressDetails {
	/** The progress percentage as a number between 0 and 100. */
	progress: number;
	/** The caption to display during progress, a string. */
	caption: string;
}
/**
 * ProgressObserver A function that receives progress updates.
 *
 * @param progress The progress percentage as a number between 0 and 100.
 */
export type ProgressObserver = (progress: number) => void;
/**
 * Listener A function for handling specific event types.
 *
 * @param event The event of type T.
 */
export type Listener<T> = (event: T) => void;
export type TSCompatibleListener<T> = EventListenerOrEventListenerObject | null | Listener<T>;
export interface ProgressReceiver {
	setProgress(details: ProgressDetails): any;
	setLoaded(): any;
}
declare class ProgressTracker extends EventTarget {
	private _selfWeight;
	private _selfDone;
	private _selfProgress;
	private _selfCaption;
	private _weight;
	private _progressObserver?;
	private _loadingListener?;
	private _isFilling;
	private _fillTime;
	private _fillInterval?;
	private _subTrackers;
	constructor({ weight, caption, fillTime, }?: ProgressTrackerOptions);
	/**
	 * Creates a new sub-tracker with a specific weight.
	 *
	 * The weight determines what percentage of the overall progress
	 * the sub-tracker represents. For example, if the main tracker is
	 * monitoring a process that has two stages, and the first stage
	 * is expected to take twice as long as the second stage, you could
	 * create the first sub-tracker with a weight of 0.67 and the second
	 * sub-tracker with a weight of 0.33.
	 *
	 * The caption is an optional string that describes the current stage
	 * of the operation. If provided, it will be used as the progress caption
	 * for the sub-tracker. If not provided, the main tracker will look for
	 * the next sub-tracker with a non-empty caption and use that as the progress
	 * caption instead.
	 *
	 * Returns the newly-created sub-tracker.
	 *
	 * @throws {Error} If the weight of the new stage would cause the total weight of all stages to exceed 1.
	 *
	 * @param weight The weight of the new stage, as a decimal value between 0 and 1.
	 * @param caption The caption for the new stage, which will be used as the progress caption for the sub-tracker.
	 *
	 * @example
	 * ```ts
	 * const tracker = new ProgressTracker();
	 * const subTracker1 = tracker.stage(0.67, 'Slow stage');
	 * const subTracker2 = tracker.stage(0.33, 'Fast stage');
	 *
	 * subTracker2.set(50);
	 * subTracker1.set(75);
	 * subTracker2.set(100);
	 * subTracker1.set(100);
	 * ```
	 */
	stage(weight?: number, caption?: string): ProgressTracker;
	/**
	 * Fills the progress bar slowly over time, simulating progress.
	 *
	 * The progress bar is filled in a 100 steps, and each step, the progress
	 * is increased by 1. If `stopBeforeFinishing` is true, the progress bar
	 * will stop filling when it reaches 99% so that you can call `finish()`
	 * explicitly.
	 *
	 * If the progress bar is filling or already filled, this method does nothing.
	 *
	 * @example
	 * ```ts
	 * const progress = new ProgressTracker({ caption: 'Processing...' });
	 * progress.fillSlowly();
	 * ```
	 *
	 * @param options Optional options.
	 */
	fillSlowly({ stopBeforeFinishing }?: {
		stopBeforeFinishing?: boolean | undefined;
	}): void;
	set(value: number): void;
	finish(): void;
	get caption(): string;
	setCaption(caption: string): void;
	get done(): boolean;
	get progress(): number;
	get weight(): number;
	get observer(): ProgressObserver;
	get loadingListener(): Listener<LoadingEvent>;
	pipe(receiver: ProgressReceiver): void;
	addEventListener(type: string, listener: TSCompatibleListener<ProgressTrackerEvent>): void;
	removeEventListener(type: string, listener: TSCompatibleListener<ProgressTrackerEvent>): void;
	private notifyProgress;
	private notifyDone;
}
export interface PHPResponseData {
	/**
	 * Response headers.
	 */
	readonly headers: Record<string, string[]>;
	/**
	 * Response body. Contains the output from `echo`,
	 * `print`, inline HTML etc.
	 */
	readonly bytes: ArrayBuffer;
	/**
	 * Stderr contents, if any.
	 */
	readonly errors: string;
	/**
	 * The exit code of the script. `0` is a success, while
	 * `1` and `2` indicate an error.
	 */
	readonly exitCode: number;
	/**
	 * Response HTTP status code, e.g. 200.
	 */
	readonly httpStatusCode: number;
}
declare class PHPResponse implements PHPResponseData {
	/** @inheritDoc */
	readonly headers: Record<string, string[]>;
	/** @inheritDoc */
	readonly bytes: ArrayBuffer;
	/** @inheritDoc */
	readonly errors: string;
	/** @inheritDoc */
	readonly exitCode: number;
	/** @inheritDoc */
	readonly httpStatusCode: number;
	constructor(httpStatusCode: number, headers: Record<string, string[]>, body: ArrayBuffer, errors?: string, exitCode?: number);
	static fromRawData(data: PHPResponseData): PHPResponse;
	toRawData(): PHPResponseData;
	/**
	 * Response body as JSON.
	 */
	get json(): any;
	/**
	 * Response body as text.
	 */
	get text(): string;
}
/**
 * Handles HTTP requests using PHP runtime as a backend.
 *
 * @public
 * @example Use PHPRequestHandler implicitly with a new PHP instance:
 * ```js
 * import { PHP } from '@php-wasm/web';
 *
 * const php = await PHP.load( '7.4', {
 *     requestHandler: {
 *         // PHP FS path to serve the files from:
 *         documentRoot: '/www',
 *
 *         // Used to populate $_SERVER['SERVER_NAME'] etc.:
 *         absoluteUrl: 'http://127.0.0.1'
 *     }
 * } );
 *
 * php.mkdirTree('/www');
 * php.writeFile('/www/index.php', '<?php echo "Hi from PHP!"; ');
 *
 * const response = await php.request({ path: '/index.php' });
 * console.log(response.text);
 * // "Hi from PHP!"
 * ```
 *
 * @example Explicitly create a PHPRequestHandler instance and run a PHP script:
 * ```js
 * import {
 *   loadPHPRuntime,
 *   PHP,
 *   PHPRequestHandler,
 *   getPHPLoaderModule,
 * } from '@php-wasm/web';
 *
 * const runtime = await loadPHPRuntime( await getPHPLoaderModule('7.4') );
 * const php = new PHP( runtime );
 *
 * php.mkdirTree('/www');
 * php.writeFile('/www/index.php', '<?php echo "Hi from PHP!"; ');
 *
 * const server = new PHPRequestHandler(php, {
 *     // PHP FS path to serve the files from:
 *     documentRoot: '/www',
 *
 *     // Used to populate $_SERVER['SERVER_NAME'] etc.:
 *     absoluteUrl: 'http://127.0.0.1'
 * });
 *
 * const response = server.request({ path: '/index.php' });
 * console.log(response.text);
 * // "Hi from PHP!"
 * ```
 */
export interface RequestHandler {
	/**
	 * Serves the request – either by serving a static file, or by
	 * dispatching it to the PHP runtime.
	 *
	 * The request() method mode behaves like a web server and only works if
	 * the PHP was initialized with a `requestHandler` option (which the online version
	 * of WordPress Playground does by default).
	 *
	 * In the request mode, you pass an object containing the request information
	 * (method, headers, body, etc.) and the path to the PHP file to run:
	 *
	 * ```ts
	 * const php = PHP.load('7.4', {
	 * 	requestHandler: {
	 * 		documentRoot: "/www"
	 * 	}
	 * })
	 * php.writeFile("/www/index.php", `<?php echo file_get_contents("php://input");`);
	 * const result = await php.request({
	 * 	method: "GET",
	 * 	headers: {
	 * 		"Content-Type": "text/plain"
	 * 	},
	 * 	body: "Hello world!",
	 * 	path: "/www/index.php"
	 * });
	 * // result.text === "Hello world!"
	 * ```
	 *
	 * The `request()` method cannot be used in conjunction with `cli()`.
	 *
	 * @example
	 * ```js
	 * const output = await php.request({
	 * 	method: 'GET',
	 * 	url: '/index.php',
	 * 	headers: {
	 * 		'X-foo': 'bar',
	 * 	},
	 * 	formData: {
	 * 		foo: 'bar',
	 * 	},
	 * });
	 * console.log(output.stdout); // "Hello world!"
	 * ```
	 *
	 * @param  request - PHP Request data.
	 */
	request(request: PHPRequest, maxRedirects?: number): Promise<PHPResponse>;
	/**
	 * Converts a path to an absolute URL based at the PHPRequestHandler
	 * root.
	 *
	 * @param  path The server path to convert to an absolute URL.
	 * @returns The absolute URL.
	 */
	pathToInternalUrl(path: string): string;
	/**
	 * Converts an absolute URL based at the PHPRequestHandler to a relative path
	 * without the server pathname and scope.
	 *
	 * @param  internalUrl An absolute URL based at the PHPRequestHandler root.
	 * @returns The relative path.
	 */
	internalUrlToPath(internalUrl: string): string;
	/**
	 * The absolute URL of this PHPRequestHandler instance.
	 */
	absoluteUrl: string;
	/**
	 * The directory in the PHP filesystem where the server will look
	 * for the files to serve. Default: `/var/www`.
	 */
	documentRoot: string;
}
export interface IsomorphicLocalPHP extends RequestHandler {
	/**
	 * Sets the path to the php.ini file to use for the PHP instance.
	 *
	 * @param path - The path to the php.ini file.
	 */
	setPhpIniPath(path: string): void;
	/**
	 * Sets a value for a specific key in the php.ini file for the PHP instance.
	 *
	 * @param key - The key to set the value for.
	 * @param value - The value to set for the key.
	 */
	setPhpIniEntry(key: string, value: string): void;
	/**
	 * Recursively creates a directory with the given path in the PHP filesystem.
	 * For example, if the path is `/root/php/data`, and `/root` already exists,
	 * it will create the directories `/root/php` and `/root/php/data`.
	 *
	 * @param  path - The directory path to create.
	 */
	mkdir(path: string): void;
	/**
	 * @deprecated Use mkdir instead.
	 */
	mkdirTree(path: string): void;
	/**
	 * Reads a file from the PHP filesystem and returns it as a string.
	 *
	 * @throws {@link @php-wasm/universal:ErrnoError} – If the file doesn't exist.
	 * @param  path - The file path to read.
	 * @returns The file contents.
	 */
	readFileAsText(path: string): string;
	/**
	 * Reads a file from the PHP filesystem and returns it as an array buffer.
	 *
	 * @throws {@link @php-wasm/universal:ErrnoError} – If the file doesn't exist.
	 * @param  path - The file path to read.
	 * @returns The file contents.
	 */
	readFileAsBuffer(path: string): Uint8Array;
	/**
	 * Overwrites data in a file in the PHP filesystem.
	 * Creates a new file if one doesn't exist yet.
	 *
	 * @param  path - The file path to write to.
	 * @param  data - The data to write to the file.
	 */
	writeFile(path: string, data: string | Uint8Array): void;
	/**
	 * Removes a file from the PHP filesystem.
	 *
	 * @throws {@link @php-wasm/universal:ErrnoError} – If the file doesn't exist.
	 * @param  path - The file path to remove.
	 */
	unlink(path: string): void;
	/**
	 * Moves a file or directory in the PHP filesystem to a
	 * new location.
	 *
	 * @param oldPath The path to rename.
	 * @param newPath The new path.
	 */
	mv(oldPath: string, newPath: string): void;
	/**
	 * Removes a directory from the PHP filesystem.
	 *
	 * @param path The directory path to remove.
	 * @param options Options for the removal.
	 */
	rmdir(path: string, options?: RmDirOptions): void;
	/**
	 * Lists the files and directories in the given directory.
	 *
	 * @param  path - The directory path to list.
	 * @param  options - Options for the listing.
	 * @returns The list of files and directories in the given directory.
	 */
	listFiles(path: string, options?: ListFilesOptions): string[];
	/**
	 * Checks if a directory exists in the PHP filesystem.
	 *
	 * @param  path – The path to check.
	 * @returns True if the path is a directory, false otherwise.
	 */
	isDir(path: string): boolean;
	/**
	 * Checks if a file (or a directory) exists in the PHP filesystem.
	 *
	 * @param  path - The file path to check.
	 * @returns True if the file exists, false otherwise.
	 */
	fileExists(path: string): boolean;
	/**
	 * Changes the current working directory in the PHP filesystem.
	 * This is the directory that will be used as the base for relative paths.
	 * For example, if the current working directory is `/root/php`, and the
	 * path is `data`, the absolute path will be `/root/php/data`.
	 *
	 * @param  path - The new working directory.
	 */
	chdir(path: string): void;
	/**
	 * Runs PHP code.
	 *
	 * This low-level method directly interacts with the WebAssembly
	 * PHP interpreter.
	 *
	 * Every time you call run(), it prepares the PHP
	 * environment and:
	 *
	 * * Resets the internal PHP state
	 * * Populates superglobals ($_SERVER, $_GET, etc.)
	 * * Handles file uploads
	 * * Populates input streams (stdin, argv, etc.)
	 * * Sets the current working directory
	 *
	 * You can use run() in two primary modes:
	 *
	 * ### Code snippet mode
	 *
	 * In this mode, you pass a string containing PHP code to run.
	 *
	 * ```ts
	 * const result = await php.run({
	 * 	code: `<?php echo "Hello world!";`
	 * });
	 * // result.text === "Hello world!"
	 * ```
	 *
	 * In this mode, information like __DIR__ or __FILE__ isn't very
	 * useful because the code is not associated with any file.
	 *
	 * Under the hood, the PHP snippet is passed to the `zend_eval_string`
	 * C function.
	 *
	 * ### File mode
	 *
	 * In the file mode, you pass a scriptPath and PHP executes a file
	 * found at a that path:
	 *
	 * ```ts
	 * php.writeFile(
	 * 	"/www/index.php",
	 * 	`<?php echo "Hello world!";"`
	 * );
	 * const result = await php.run({
	 * 	scriptPath: "/www/index.php"
	 * });
	 * // result.text === "Hello world!"
	 * ```
	 *
	 * In this mode, you can rely on path-related information like __DIR__
	 * or __FILE__.
	 *
	 * Under the hood, the PHP file is executed with the `php_execute_script`
	 * C function.
	 *
	 * The `run()` method cannot be used in conjunction with `cli()`.
	 *
	 * @example
	 * ```js
	 * const result = await php.run(`<?php
	 *  $fp = fopen('php://stderr', 'w');
	 *  fwrite($fp, "Hello, world!");
	 * `);
	 * // result.errors === "Hello, world!"
	 * ```
	 *
	 * @param  options - PHP runtime options.
	 */
	run(options: PHPRunOptions): Promise<PHPResponse>;
	/**
	 * Listens to message sent by the PHP code.
	 *
	 * To dispatch messages, call:
	 *
	 *     post_message_to_js(string $data)
	 *
	 *     Arguments:
	 *         $data (string) – Data to pass to JavaScript.
	 *
	 * @example
	 *
	 * ```ts
	 * const php = await PHP.load('8.0');
	 *
	 * php.onMessage(
	 *     // The data is always passed as a string
	 *     function (data: string) {
	 *         // Let's decode and log the data:
	 *         console.log(JSON.parse(data));
	 *     }
	 * );
	 *
	 * // Now that we have a listener in place, let's
	 * // dispatch a message:
	 * await php.run({
	 *     code: `<?php
	 *         post_message_to_js(
	 *             json_encode([
	 *                 'post_id' => '15',
	 *                 'post_title' => 'This is a blog post!'
	 *             ])
	 *         ));
	 *     `,
	 * });
	 * ```
	 *
	 * @param listener Callback function to handle the message.
	 */
	onMessage(listener: MessageListener): void;
}
export type MessageListener = (data: string) => void;
export type IsomorphicRemotePHP = Remote<IsomorphicLocalPHP>;
export type UniversalPHP = IsomorphicLocalPHP | IsomorphicRemotePHP;
export type HTTPMethod = "GET" | "POST" | "HEAD" | "OPTIONS" | "PATCH" | "PUT" | "DELETE";
export type PHPRequestHeaders = Record<string, string>;
export interface PHPRequest {
	/**
	 * Request method. Default: `GET`.
	 */
	method?: HTTPMethod;
	/**
	 * Request path or absolute URL.
	 */
	url: string;
	/**
	 * Request headers.
	 */
	headers?: PHPRequestHeaders;
	/**
	 * Uploaded files
	 */
	files?: Record<string, File>;
	/**
	 * Request body without the files.
	 */
	body?: string;
	/**
	 * Form data. If set, the request body will be ignored and
	 * the content-type header will be set to `application/x-www-form-urlencoded`.
	 */
	formData?: Record<string, unknown>;
}
export interface PHPRunOptions {
	/**
	 * Request path following the domain:port part.
	 */
	relativeUri?: string;
	/**
	 * Path of the .php file to execute.
	 */
	scriptPath?: string;
	/**
	 * Request protocol.
	 */
	protocol?: string;
	/**
	 * Request method. Default: `GET`.
	 */
	method?: HTTPMethod;
	/**
	 * Request headers.
	 */
	headers?: PHPRequestHeaders;
	/**
	 * Request body without the files.
	 */
	body?: string;
	/**
	 * Uploaded files.
	 */
	fileInfos?: FileInfo[];
	/**
	 * The code snippet to eval instead of a php file.
	 */
	code?: string;
}
export interface FileInfo {
	key: string;
	name: string;
	type: string;
	data: Uint8Array;
}
export interface RmDirOptions {
	/**
	 * If true, recursively removes the directory and all its contents.
	 * Default: true.
	 */
	recursive?: boolean;
}
export interface ListFilesOptions {
	/**
	 * If true, prepend given folder path to all file names.
	 * Default: false.
	 */
	prependPath: boolean;
}
declare const SupportedPHPVersions: readonly [
	"8.2",
	"8.1",
	"8.0",
	"7.4",
	"7.3",
	"7.2",
	"7.1",
	"7.0",
	"5.6"
];
export type SupportedPHPVersion = (typeof SupportedPHPVersions)[number];
export interface SemaphoreOptions {
	concurrency: number;
}
declare class Semaphore {
	private _running;
	private concurrency;
	private queue;
	constructor({ concurrency }: SemaphoreOptions);
	get running(): number;
	acquire(): Promise<() => void>;
	run<T>(fn: () => Promise<T>): Promise<T>;
}
export declare const ResourceTypes: readonly [
	"vfs",
	"literal",
	"wordpress.org/themes",
	"wordpress.org/plugins",
	"url"
];
export type VFSReference = {
	/** Identifies the file resource as Virtual File System (VFS) */
	resource: "vfs";
	/** The path to the file in the VFS */
	path: string;
};
export type LiteralReference = {
	/** Identifies the file resource as a literal file */
	resource: "literal";
	/** The name of the file */
	name: string;
	/** The contents of the file */
	contents: string | Uint8Array;
};
export type CoreThemeReference = {
	/** Identifies the file resource as a WordPress Core theme */
	resource: "wordpress.org/themes";
	/** The slug of the WordPress Core theme */
	slug: string;
};
export type CorePluginReference = {
	/** Identifies the file resource as a WordPress Core plugin */
	resource: "wordpress.org/plugins";
	/** The slug of the WordPress Core plugin */
	slug: string;
};
export type UrlReference = {
	/** Identifies the file resource as a URL */
	resource: "url";
	/** The URL of the file */
	url: string;
	/** Optional caption for displaying a progress message */
	caption?: string;
};
export type FileReference = VFSReference | LiteralReference | CoreThemeReference | CorePluginReference | UrlReference;
export interface ResourceOptions {
	/** Optional semaphore to limit concurrent downloads */
	semaphore?: Semaphore;
	progress?: ProgressTracker;
}
export declare abstract class Resource {
	/** Optional progress tracker to monitor progress */
	abstract progress?: ProgressTracker;
	/** A Promise that resolves to the file contents */
	protected promise?: Promise<File>;
	protected playground?: UniversalPHP;
	/**
	 * Creates a new Resource based on the given file reference
	 *
	 * @param ref The file reference to create the Resource for
	 * @param options Additional options for the Resource
	 * @returns A new Resource instance
	 */
	static create(ref: FileReference, { semaphore, progress }: ResourceOptions): Resource;
	setPlayground(playground: UniversalPHP): void;
	/**
	 * Resolves the file contents
	 * @returns The resolved file.
	 */
	abstract resolve(): Promise<File>;
	/** The name of the referenced file */
	abstract get name(): string;
	/** Whether this Resource is loaded asynchronously */
	get isAsync(): boolean;
}
/**
 * A `Resource` that represents a file in the VFS (virtual file system) of the playground.
 */
export declare class VFSResource extends Resource {
	private resource;
	progress?: ProgressTracker | undefined;
	/**
	 * Creates a new instance of `VFSResource`.
	 * @param playground The playground client.
	 * @param resource The VFS reference.
	 * @param progress The progress tracker.
	 */
	constructor(resource: VFSReference, progress?: ProgressTracker | undefined);
	/** @inheritDoc */
	resolve(): Promise<File>;
	/** @inheritDoc */
	get name(): string;
}
/**
 * A `Resource` that represents a literal file.
 */
export declare class LiteralResource extends Resource {
	private resource;
	progress?: ProgressTracker | undefined;
	/**
	 * Creates a new instance of `LiteralResource`.
	 * @param resource The literal reference.
	 * @param progress The progress tracker.
	 */
	constructor(resource: LiteralReference, progress?: ProgressTracker | undefined);
	/** @inheritDoc */
	resolve(): Promise<File>;
	/** @inheritDoc */
	get name(): string;
}
/**
 * A base class for `Resource`s that require fetching data from a remote URL.
 */
export declare abstract class FetchResource extends Resource {
	progress?: ProgressTracker | undefined;
	/**
	 * Creates a new instance of `FetchResource`.
	 * @param progress The progress tracker.
	 */
	constructor(progress?: ProgressTracker | undefined);
	/** @inheritDoc */
	resolve(): Promise<File>;
	/**
	 * Gets the URL to fetch the data from.
	 * @returns The URL.
	 */
	protected abstract getURL(): string;
	/**
	 * Gets the caption for the progress tracker.
	 * @returns The caption.
	 */
	protected get caption(): string;
	/** @inheritDoc */
	get name(): string;
	/** @inheritDoc */
	get isAsync(): boolean;
}
/**
 * A `Resource` that represents a file available from a URL.
 */
export declare class UrlResource extends FetchResource {
	private resource;
	/**
	 * Creates a new instance of `UrlResource`.
	 * @param resource The URL reference.
	 * @param progress The progress tracker.
	 */
	constructor(resource: UrlReference, progress?: ProgressTracker);
	/** @inheritDoc */
	getURL(): string;
	/** @inheritDoc */
	protected get caption(): string;
}
export declare function setPluginProxyURL(url: string): void;
/**
 * A `Resource` that represents a WordPress core theme.
 */
export declare class CoreThemeResource extends FetchResource {
	private resource;
	constructor(resource: CoreThemeReference, progress?: ProgressTracker);
	get name(): string;
	getURL(): string;
}
/**
 * A resource that fetches a WordPress plugin from wordpress.org.
 */
export declare class CorePluginResource extends FetchResource {
	private resource;
	constructor(resource: CorePluginReference, progress?: ProgressTracker);
	/** @inheritDoc */
	get name(): string;
	/** @inheritDoc */
	getURL(): string;
}
/**
 * A decorator for a resource that adds functionality such as progress tracking and caching.
 */
export declare class DecoratedResource<T extends Resource> extends Resource {
	private resource;
	constructor(resource: T);
	/** @inheritDoc */
	resolve(): Promise<File>;
	/** @inheritDoc */
	setPlayground(playground: UniversalPHP): Promise<void>;
	/** @inheritDoc */
	get progress(): ProgressTracker | undefined;
	/** @inheritDoc */
	set progress(value: ProgressTracker | undefined);
	/** @inheritDoc */
	get name(): string;
	/** @inheritDoc */
	get isAsync(): boolean;
}
/**
 * A decorator for a resource that adds caching functionality.
 */
export declare class CachedResource<T extends Resource> extends DecoratedResource<T> {
	protected promise?: Promise<File>;
	/** @inheritDoc */
	resolve(): Promise<File>;
}
/**
 * A decorator for a resource that adds concurrency control functionality through a semaphore.
 */
export declare class SemaphoreResource<T extends Resource> extends DecoratedResource<T> {
	private readonly semaphore;
	constructor(resource: T, semaphore: Semaphore);
	/** @inheritDoc */
	resolve(): Promise<File>;
}
/**
 * @inheritDoc activatePlugin
 */
export interface ActivatePluginStep {
	step: "activatePlugin";
	/** Path to the plugin directory as absolute path (/wordpress/wp-content/plugins/plugin-name); or the plugin entry file relative to the plugins directory (plugin-name/plugin-name.php). */
	pluginPath: string;
	/** Optional. Plugin name to display in the progress bar. */
	pluginName?: string;
}
/**
 * Activates a WordPress plugin (if it's installed).
 *
 * @param playground The playground client.
 */
export declare const activatePlugin: StepHandler<ActivatePluginStep>;
/**
 * @private
 */
export interface ApplyWordPressPatchesStep {
	step: "applyWordPressPatches";
	siteUrl?: string;
	wordpressPath?: string;
	addPhpInfo?: boolean;
	patchSecrets?: boolean;
	disableSiteHealth?: boolean;
	disableWpNewBlogNotification?: boolean;
}
export declare const applyWordPressPatches: StepHandler<ApplyWordPressPatchesStep>;
/**
 * @inheritDoc defineSiteUrl
 * @hasRunnableExample
 * @example
 *
 * <code>
 * {
 * 		"step": "defineSiteUrl",
 * 		"siteUrl": "https://playground.wordpress.net"
 * }
 * </code>
 */
export interface DefineSiteUrlStep {
	step: "defineSiteUrl";
	/** The URL */
	siteUrl: string;
}
/**
 * Sets WP_HOME and WP_SITEURL constants for the WordPress installation.
 *
 * @param playground The playground client.
 * @param siteUrl
 */
export declare const defineSiteUrl: StepHandler<DefineSiteUrlStep>;
/**
 * Full site export support:
 */
/**
 * Export the current site as a zip file.
 *
 * @param playground Playground client.
 */
export declare function zipEntireSite(playground: UniversalPHP): Promise<File>;
/**
 * @inheritDoc replaceSite
 */
export interface ReplaceSiteStep<ResourceType> {
	step: "replaceSite";
	/** The zip file containing the new WordPress site */
	fullSiteZip: ResourceType;
}
/**
 * Replace the current site with a site from the provided zip file.
 * Remember to install the SQLite integration plugin in the zipped site:
 * https://wordpress.org/plugins/sqlite-database-integration.
 *
 * @param playground Playground client.
 * @param fullSiteZip Zipped WordPress site.
 */
export declare const replaceSite: StepHandler<ReplaceSiteStep<File>>;
/**
 * @inheritDoc unzip
 */
export interface UnzipStep {
	step: "unzip";
	/** The zip file to extract */
	zipPath: string;
	/** The path to extract the zip file to */
	extractToPath: string;
}
/**
 * Unzip a zip file.
 *
 * @param playground Playground client.
 * @param zipPath The zip file to unzip.
 * @param extractTo The directory to extract the zip file to.
 */
export declare const unzip: StepHandler<UnzipStep>;
/**
 * @inheritDoc importFile
 */
export interface ImportFileStep<ResourceType> {
	step: "importFile";
	/** The file to import */
	file: ResourceType;
}
/**
 * Uploads a file to the WordPress importer and returns the response.
 * Supports both WXR and WXZ files.
 *
 * @see https://github.com/WordPress/wordpress-importer/compare/master...akirk:wordpress-importer:import-wxz.patch
 * @param playground Playground client.
 * @param file The file to import.
 */
export declare const importFile: StepHandler<ImportFileStep<File>>;
/**
 * @inheritDoc installPlugin
 * @hasRunnableExample
 * @needsLogin
 * @landingPage /wp-admin/plugins.php
 * @example
 *
 * <code>
 * {
 * 	    "step": "installPlugin",
 * 		"pluginZipFile": {
 * 			"resource": "wordpress.org/plugins",
 * 			"slug": "gutenberg"
 * 		},
 * 		"options": {
 * 			"activate": true
 * 		}
 * }
 * </code>
 */
export interface InstallPluginStep<ResourceType> {
	/**
	 * The step identifier.
	 */
	step: "installPlugin";
	/**
	 * The plugin zip file to install.
	 */
	pluginZipFile: ResourceType;
	/**
	 * Optional installation options.
	 */
	options?: InstallPluginOptions;
}
export interface InstallPluginOptions {
	/**
	 * Whether to activate the plugin after installing it.
	 */
	activate?: boolean;
}
/**
 * Installs a WordPress plugin in the Playground.
 *
 * @param playground The playground client.
 * @param pluginZipFile The plugin zip file.
 * @param options Optional. Set `activate` to false if you don't want to activate the plugin.
 */
export declare const installPlugin: StepHandler<InstallPluginStep<File>>;
/**
 * @inheritDoc installTheme
 * @hasRunnableExample
 * @needsLogin
 * @example
 *
 * <code>
 * {
 * 		"step": "installTheme",
 * 		"themeZipFile": {
 * 			"resource": "wordpress.org/themes",
 * 			"slug": "pendant"
 * 		},
 * 		"options": {
 * 			"activate": true
 * 		}
 * }
 * </code>
 */
export interface InstallThemeStep<ResourceType> {
	/**
	 * The step identifier.
	 */
	step: "installTheme";
	/**
	 * The theme zip file to install.
	 */
	themeZipFile: ResourceType;
	/**
	 * Optional installation options.
	 */
	options?: {
		/**
		 * Whether to activate the theme after installing it.
		 */
		activate?: boolean;
	};
}
export interface InstallThemeOptions {
	/**
	 * Whether to activate the theme after installing it.
	 */
	activate?: boolean;
}
/**
 * Installs a WordPress theme in the Playground.
 *
 * @param playground The playground client.
 * @param themeZipFile The theme zip file.
 * @param options Optional. Set `activate` to false if you don't want to activate the theme.
 */
export declare const installTheme: StepHandler<InstallThemeStep<File>>;
/**
 * @inheritDoc login
 * @hasRunnableExample
 * @example
 *
 * <code>
 * {
 * 	    "step": "login",
 * 		"username": "admin",
 * 		"password": "password"
 * }
 * </code>
 */
export type LoginStep = {
	step: "login";
	/**
	 * The user to log in as. Defaults to 'admin'.
	 */
	username?: string;
	/**
	 * The password to log in with. Defaults to 'password'.
	 */
	password?: string;
};
/**
 * Logs in to the Playground.
 * Under the hood, this function submits the wp-login.php form
 * just like a user would.
 */
export declare const login: StepHandler<LoginStep>;
/**
 * @private
 */
export interface RunWpInstallationWizardStep {
	step: "runWpInstallationWizard";
	options: WordPressInstallationOptions;
}
export interface WordPressInstallationOptions {
	adminUsername?: string;
	adminPassword?: string;
}
/**
 * Installs WordPress
 *
 * @param playground The playground client.
 * @param options Installation options.
 */
export declare const runWpInstallationWizard: StepHandler<RunWpInstallationWizardStep>;
/**
 * @inheritDoc setSiteOptions
 * @hasRunnableExample
 *
 * @example
 *
 * <code>
 * {
 *     "step": "setSiteOptions",
 *     "options": {
 *         "blogname": "My Blog",
 *         "blogdescription": "A great blog"
 *     }
 * }
 * </code>
 */
export type SetSiteOptionsStep = {
	/** The name of the step. Must be "setSiteOptions". */
	step: "setSiteOptions";
	/** The options to set on the site. */
	options: Record<string, unknown>;
};
/**
 * Sets site options. This is equivalent to calling `update_option` for each
 * option in the `options` object.
 */
export declare const setSiteOptions: StepHandler<SetSiteOptionsStep>;
/**
 * @inheritDoc updateUserMeta
 * @hasRunnableExample
 *
 * @example
 *
 * <code>
 * {
 *     "step": "updateUserMeta",
 *     "meta": {
 * 	       "first_name": "John",
 * 	       "last_name": "Doe"
 *     },
 *     "userId": 1
 * }
 * </code>
 */
export interface UpdateUserMetaStep {
	step: "updateUserMeta";
	/** An object of user meta values to set, e.g. { "first_name": "John" } */
	meta: Record<string, unknown>;
	/** User ID */
	userId: number;
}
/**
 * Updates user meta. This is equivalent to calling `update_user_meta` for each
 * meta value in the `meta` object.
 */
export declare const updateUserMeta: StepHandler<UpdateUserMetaStep>;
/**
 * @inheritDoc runPHP
 * @hasRunnableExample
 * @example
 *
 * <code>
 * {
 * 		"step": "runPHP",
 * 		"code": "<?php echo 'Hello World'; ?>"
 * }
 * </code>
 */
export interface RunPHPStep {
	/** The step identifier. */
	step: "runPHP";
	/** The PHP code to run. */
	code: string;
}
/**
 * Runs PHP code.
 */
export declare const runPHP: StepHandler<RunPHPStep>;
/**
 * @inheritDoc runPHP
 * @hasRunnableExample
 * @example
 *
 * <code>
 * {
 * 		"step": "runPHP",
 * 		"options": {
 * 			"code": "<?php echo $_SERVER['CONTENT_TYPE']; ?>",
 * 			"headers": {
 * 				"Content-type": "text/plain"
 * 			}
 * 		}
 * }
 * </code>
 */
export interface RunPHPWithOptionsStep {
	step: "runPHPWithOptions";
	/**
	 * Run options (See /wordpress-playground/api/universal/interface/PHPRunOptions)
	 */
	options: PHPRunOptions;
}
/**
 * Runs PHP code with the given options.
 */
export declare const runPHPWithOptions: StepHandler<RunPHPWithOptionsStep>;
/**
 * @inheritDoc setPhpIniEntry
 * @hasRunnableExample
 * @example
 *
 * <code>
 * {
 * 		"step": "setPhpIniEntry",
 * 		"key": "display_errors",
 * 		"value": "1"
 * }
 * </code>
 */
export interface SetPhpIniEntryStep {
	step: "setPhpIniEntry";
	/** Entry name e.g. "display_errors" */
	key: string;
	/** Entry value as a string e.g. "1" */
	value: string;
}
/**
 * Sets a PHP ini entry.
 */
export declare const setPhpIniEntry: StepHandler<SetPhpIniEntryStep>;
/**
 * @inheritDoc request
 * @needsLogin
 * @hasRunnableExample
 * @example
 *
 * <code>
 * {
 * 		"step": "request",
 * 		"request": {
 * 			"method": "POST",
 * 			"url": "/wp-admin/admin-ajax.php",
 * 			"formData": {
 * 				"action": "my_action",
 * 				"foo": "bar"
 * 			}
 * 		}
 * }
 * </code>
 */
export interface RequestStep {
	step: "request";
	/**
	 * Request details (See /wordpress-playground/api/universal/interface/PHPRequest)
	 */
	request: PHPRequest;
}
/**
 * Sends a HTTP request to the Playground.
 */
export declare const request: StepHandler<RequestStep>;
/**
 * @inheritDoc cp
 * @hasRunnableExample
 * @landingPage /index2.php
 * @example
 *
 * <code>
 * {
 * 		"step": "cp",
 * 		"fromPath": "/wordpress/index.php",
 * 		"toPath": "/wordpress/index2.php"
 * }
 * </code>
 */
export interface CpStep {
	step: "cp";
	/** Source path */
	fromPath: string;
	/** Target path */
	toPath: string;
}
/**
 * Copies a file from one path to another.
 */
export declare const cp: StepHandler<CpStep>;
/**
 * @inheritDoc mv
 * @hasRunnableExample
 * @landingPage /index2.php
 * @example
 *
 * <code>
 * {
 * 		"step": "mv",
 * 		"fromPath": "/wordpress/index.php",
 * 		"toPath": "/wordpress/index2.php"
 * }
 * </code>
 */
export interface MvStep {
	step: "mv";
	/** Source path */
	fromPath: string;
	/** Target path */
	toPath: string;
}
/**
 * Moves a file or directory from one path to another.
 */
export declare const mv: StepHandler<MvStep>;
/**
 * @inheritDoc mkdir
 * @hasRunnableExample
 * @example
 *
 * <code>
 * {
 * 		"step": "mkdir",
 * 		"path": "/wordpress/my-new-folder"
 * }
 * </code>
 */
export interface MkdirStep {
	step: "mkdir";
	/** The path of the directory you want to create */
	path: string;
}
/**
 * Creates a directory at the specified path.
 */
export declare const mkdir: StepHandler<MkdirStep>;
/**
 * @inheritDoc rm
 * @hasRunnableExample
 * @landingPage /index.php
 * @example
 *
 * <code>
 * {
 * 		"step": "rm",
 * 		"path": "/wordpress/index.php"
 * }
 * </code>
 */
export interface RmStep {
	step: "rm";
	/** The path to remove */
	path: string;
}
/**
 * Removes a file at the specified path.
 */
export declare const rm: StepHandler<RmStep>;
/**
 * @inheritDoc rmdir
 * @hasRunnableExample
 * @landingPage /wp-admin/
 * @example
 *
 * <code>
 * {
 * 		"step": "rm",
 * 		"path": "/wordpress/wp-admin"
 * }
 * </code>
 */
export interface RmdirStep {
	step: "rmdir";
	/** The path to remove */
	path: string;
}
/**
 * Removes a directory at the specified path.
 */
export declare const rmdir: StepHandler<RmdirStep>;
/**
 * @inheritDoc writeFile
 * @hasRunnableExample
 * @landingPage /test.php
 * @example
 *
 * <code>
 * {
 * 		"step": "writeFile",
 * 		"path": "/wordpress/test.php",
 * 		"data": "<?php echo 'Hello World!'; ?>"
 * }
 * </code>
 */
export interface WriteFileStep<ResourceType> {
	step: "writeFile";
	/** The path of the file to write to */
	path: string;
	/** The data to write */
	data: ResourceType | string | Uint8Array;
}
/**
 * Writes data to a file at the specified path.
 */
export declare const writeFile: StepHandler<WriteFileStep<File>>;
/**
 * @inheritDoc defineWpConfigConsts
 * @hasRunnableExample
 * @example
 *
 * <code>
 * {
 * 		"step": "defineWpConfigConsts",
 * 		"consts": {
 *          "WP_DEBUG": true
 *      },
 *      "virtualize": true
 * }
 * </code>
 */
export interface DefineWpConfigConstsStep {
	step: "defineWpConfigConsts";
	/** The constants to define */
	consts: Record<string, unknown>;
	/**
	 * Enables the virtualization of wp-config.php and playground-consts.json files, leaving the local system files untouched.
	 * The variables defined in the /vfs-blueprints/playground-consts.json file are loaded via the auto_prepend_file directive in the php.ini file.
	 * @default false
	 * @see https://www.php.net/manual/en/ini.core.php#ini.auto-prepend-file
	 */
	virtualize?: boolean;
}
/**
 * Defines the wp-config.php constants
 *
 * @param playground The playground client.
 * @param wpConfigConst
 */
export declare const defineWpConfigConsts: StepHandler<DefineWpConfigConstsStep>;
/**
 * @inheritDoc activateTheme
 */
export interface ActivateThemeStep {
	step: "activateTheme";
	/**
	 * The name of the theme folder inside wp-content/themes/
	 */
	themeFolderName: string;
}
/**
 * Activates a WordPress theme (if it's installed).
 *
 * @param playground The playground client.
 * @param themeFolderName The theme folder name.
 */
export declare const activateTheme: StepHandler<ActivateThemeStep>;
export type Step = GenericStep<FileReference>;
export type StepDefinition = Step & {
	progress?: {
		weight?: number;
		caption?: string;
	};
};
/**
 * If you add a step here, make sure to also
 * add it to the exports below.
 */
export type GenericStep<Resource> = ActivatePluginStep | ActivateThemeStep | ApplyWordPressPatchesStep | CpStep | DefineWpConfigConstsStep | DefineSiteUrlStep | ImportFileStep<Resource> | InstallPluginStep<Resource> | InstallThemeStep<Resource> | LoginStep | MkdirStep | MvStep | RequestStep | ReplaceSiteStep<Resource> | RmStep | RmdirStep | RunPHPStep | RunPHPWithOptionsStep | RunWpInstallationWizardStep | SetPhpIniEntryStep | SetSiteOptionsStep | UnzipStep | UpdateUserMetaStep | WriteFileStep<Resource>;
/**
 * Progress reporting details.
 */
export type StepProgress = {
	tracker: ProgressTracker;
	initialCaption?: string;
};
export type StepHandler<S extends GenericStep<File>> = (
/**
 * A PHP instance or Playground client.
 */
php: UniversalPHP, args: Omit<S, "step">, progressArgs?: StepProgress) => any;
export interface Blueprint {
	/**
	 * The URL to navigate to after the blueprint has been run.
	 */
	landingPage?: string;
	/**
	 * The preferred PHP and WordPress versions to use.
	 */
	preferredVersions?: {
		/**
		 * The preferred PHP version to use.
		 * If not specified, the latest supported version will be used
		 */
		php: SupportedPHPVersion | "latest";
		/**
		 * The preferred WordPress version to use.
		 * If not specified, the latest supported version will be used
		 */
		wp: string | "latest";
	};
	/**
	 * The steps to run.
	 */
	steps?: Array<StepDefinition | string | undefined | false | null>;
}
export type CompiledStep = (php: UniversalPHP) => Promise<void> | void;
declare const supportedWordPressVersions: readonly [
	"6.2",
	"6.1",
	"6.0",
	"5.9",
	"nightly"
];
export type supportedWordPressVersion = (typeof supportedWordPressVersions)[number];
export interface CompiledBlueprint {
	/** The requested versions of PHP and WordPress for the blueprint */
	versions: {
		php: SupportedPHPVersion;
		wp: supportedWordPressVersion;
	};
	/** The compiled steps for the blueprint */
	run: (playground: UniversalPHP) => Promise<void>;
}
export type OnStepCompleted = (output: any, step: StepDefinition) => any;
export interface CompileBlueprintOptions {
	/** Optional progress tracker to monitor progress */
	progress?: ProgressTracker;
	/** Optional semaphore to control access to a shared resource */
	semaphore?: Semaphore;
	/** Optional callback with step output */
	onStepCompleted?: OnStepCompleted;
}
/**
 * Compiles Blueprint into a form that can be executed.
 *
 * @param playground The PlaygroundClient to use for the compilation
 * @param blueprint The bBueprint to compile
 * @param options Additional options for the compilation
 * @returns The compiled blueprint
 */
export declare function compileBlueprint(blueprint: Blueprint, { progress, semaphore, onStepCompleted, }?: CompileBlueprintOptions): CompiledBlueprint;
export declare function runBlueprintSteps(compiledBlueprint: CompiledBlueprint, playground: UniversalPHP): Promise<void>;

export {};
